# 系统设置更新指南

## 更新内容

此次更新将所有数据配置相关功能改为MySQL数据库存储，主要包括：
- 积分规则配置
- 普通用户每日扔瓶限制
- 普通用户每日捡瓶限制
- VIP用户每日扔瓶限制
- VIP用户每日捡瓶限制
- 新增admin/settings.php系统设置页面
- 支持修改网站名称等基本设置

## 实施步骤

1. 导入系统设置表：
   ```sql
   source system_settings.sql
   ```

2. 更新管理员权限设置：
   ```sql
   source update_admin_roles.sql
   ```

3. 完成后即可通过管理后台的"系统设置"进行配置管理

## 功能说明

### 系统设置页面

系统设置页面分为四个主要模块：
- **基本设置**：网站名称、网站URL、管理员邮箱等
- **积分规则**：签到积分、VIP额外积分、点赞获得积分等规则
- **用户限制**：普通用户和VIP用户的每日扔瓶和捡瓶限制
- **内容设置**：漂流瓶内容长度限制、评论长度限制等

### 配置实时生效

所有配置修改后立即生效，无需重启服务器。系统会自动从数据库读取最新的配置值。

## 技术细节

1. 通过`includes/config.php`中的`getSetting`方法获取配置值
2. 使用`updateSetting`函数更新配置值
3. 为确保向后兼容，所有配置仍定义为PHP常量，但值从数据库获取

## 注意事项

1. 首次安装需确保`system_settings`表创建并初始化
2. 管理员需要拥有`settings`权限才能访问系统设置页面
3. 如果遇到权限问题，请确认管理员角色权限是否包含`settings`权限 